# mallocの概要

## ざっくり動作解説

アドレス空間のうちヒープ領域を使用する。
まずは特定のサイズのヒープ領域を空きプールとして確保する。

    - sbrk()を用いて現在のヒープ領域を拡張する。
    - 空きプールがなくなったら随時sbrk()を発行。

mallocはchunkという単位で確保したプールからメモリを切り出す。
mallocを呼び出した側には、chunkの管理部分を除いた領域の先頭アドレスを返す。

[こんな感じらしい](https://qiita.com/kaityo256/items/9e78b507940b2292bf79)

メモリプールとは別にメモリプール全体を管理する管理部がある。
メモリプールと管理部を一つのまとまりにした管理単位をarenaと呼ぶ。

## arenaの構造
### arenaの管理部分

デフォルトのarenaの管理部分は変数main_arenaで管理される。
プログラム起動時はmain_arenaが存在するだけで、メモリプールは存在しない。
最初のメモリプールの確保は空きエリアがない場合に、ヒープ領域を拡張する処理と同じ処理の流れで行われる。

